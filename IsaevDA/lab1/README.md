# Практическая работа №1. Обработка изображений с использованием библиотеки OpenCV

## Описание программы

Программа позволяет загружать изображение и применять к нему различные фильтры: **оттенки серого**, **изменение разрешения**, **сепия**, **виньетка**, и **пикселизация**. Фильтры реализованы с использованием библиотеки OpenCV, и результаты сохраняются в отдельный файл.

## Алгоритм фильтров

### 1. **Фильтр оттенков серого (Grayscale)**

Фильтр преобразует изображение в оттенки серого, используя известную формулу:
```math
Y = 0.3 * R + 0.59 * G + 0.11 * B
```

Здесь используются коэффициенты для каждой из цветовых компонент, чтобы получить взвешенную среднюю интенсивность света. Это дает более естественное восприятие человеческим глазом, так как зеленый цвет воспринимается ярче, чем красный или синий.

### 2. **Изменение разрешения (Resize)**

Фильтр уменьшает или увеличивает разрешение изображения в соответствии с заданным масштабом. Новый размер изображения определяется путем пропорционального масштабирования по обеим осям с сохранением аспектного отношения. Каждый пиксель изображения пересчитывается с учетом пропорций.

### 3. **Сепия (Sepia)**

Фильтр добавляет "сепийный" эффект, придавая изображению теплый, коричневатый оттенок. Для каждой пиксельной точки цвета (R, G, B) вычисляются новые значения:
```math
R' = 0.393 * R + 0.769 * G + 0.189 * B
```
```math
G' = 0.349 * R + 0.686 * G + 0.168 * B
```
```math
B' = 0.272 * R + 0.534 * G + 0.131 * B
```
Новые значения ограничиваются диапазоном от 0 до 255, чтобы избежать артефактов.

### 4. **Виньетка (Vignette)**

Фильтр создает эффект затемнения краев изображения, добавляя круговую виньетку с заданным радиусом и интенсивностью. Радиус виньетки определяется как процент от минимального размера изображения (высота или ширина), а интенсивность контролирует степень затемнения краев. Маска виньетки создается с помощью гауссового распределения, применяемого ко всем пикселям изображения.

### 5. **Пикселизация (Pixelation)**

Фильтр пикселизирует выбранную пользователем область изображения. Изображение разбивается на блоки фиксированного размера, и каждый блок заменяется его средним цветом. Это создает эффект снижения разрешения в выбранной области изображения.

## Описание команд

Программа использует интерфейс командной строки, в котором можно указать режим работы, фильтр, путь к входному изображению и имя выходного файла. Ниже приводится описание всех поддерживаемых команд и аргументов.

### Общий формат команды:

```
python image_processing.py --mode <режим> --func <фильтр> --image <путь к изображению> --output <имя выходного файла>
```

### Аргументы:

- `--mode` или `-m`: Режим работы программы. Возможные значения:
  - `image`: Режим просмотра изображения без обработки. Позволяет открыть и просмотреть исходное изображение в отдельном окне. Режим по умолчанию (можно не ставить флаг `--mode` или `-m`).
  - `imgproc`: Режим обработки изображения с применением фильтров.

- `--func` или `-f`: Указывает фильтр, который нужно применить при выборе режима `imgproc`. Возможные фильтры:
  - `grayscale`: Применяет фильтр оттенков серого.
  - `resize`: Изменяет размер изображения, уменьшая его в два раза.
  - `sepia`: Применяет сепийный эффект.
  - `vignette`: Добавляет эффект виньетки с возможностью управления интенсивностью и радиусом.
  - `pixelation`: Применяет пикселизацию к выбранной области изображения.

- `--image` или `-i`: Путь к входному изображению, которое необходимо обработать или просмотреть.

- `--output` или `-o`: Имя выходного файла, в который будет сохранено обработанное изображение. Если не указано, по умолчанию файл будет сохранен как `image_out.jpg`. Если файл с таким именем уже существует, будет сгенерировано уникальное имя (например, `image_out_1.jpg`).

- `--vignette-intensity` или `-v`: Интенсивность виньетки от 0 до 1 (не включительно), по умолчанию — 0.15. Определяет, насколько сильно затемняются края изображения.
- `--vignette-radius` или `-r`: Радиус виньетки от 0 до 1, по умолчанию — 0.5. Определяет, как далеко от центра изображения распространяется виньетка.
- `--scale` или `-s`: Масштаб изображения для фильтра resize, по умолчанию — 0.5. Определяет, насколько будет уменьшено (или увеличено) изображение.
- `--pixel-size` или `-p`: Размер блока пикселей для фильтра пикселизации, по умолчанию — 30.

### Пример использования

Для запуска программы с фильтром оттенков серого:
```
python image_processing.py --mode imgproc --func grayscale --image input.jpg --output output.jpg
```

Для просмотра исходного изображения:
```
python image_processing.py -i input.jpg
```

Применение фильтра виньетки с радиусом 0.4 и интенсивностью 0.7:
```
python image_processing.py --mode imgproc --func vignette --image input.jpg --output output.jpg --vignette-intensity 0.7 --vignette-radius 0.4
```