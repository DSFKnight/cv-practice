# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Описание работы

Цель работы — разработать приложение для классификации изображений набора данных **dogs-vs-cats** с использованием алгоритма "мешок слов" (Bag of Visual Words). В рамках работы реализованы этапы обработки изображений, построения "мешка слов", обучения классификационной модели и оценки её качества на тестовой выборке.

## Описание алгоритма

### Этап 1: Загрузка данных
- Набор данных состоит из изображений двух классов: "кошки" и "собаки".
- 200 изображений используются в качестве обучающей выборки (по 100 для каждого класса).
- 200 изображений используются в качестве тестовой выборки (по 100 для каждого класса).

### Этап 2: Извлечение признаков
- Используются два алгоритма для извлечения локальных признаков:
  - **SIFT** (Scale-Invariant Feature Transform).
  - **ORB** (Oriented FAST and Rotated BRIEF).
- Признаки извлекаются из изображений, предварительно преобразованных в оттенки серого и масштабированных до размера 256×256 пикселей.

### Этап 3: Создание "мешка слов"
- Выделенные признаки объединяются в кластеры с использованием алгоритма **KMeans**.
- Кластеры представляют собой "визуальные слова".
- Для каждого изображения строится гистограмма распределения его признаков по кластерам, которая используется как вектор признаков для классификации.

### Этап 4: Классификация
- Реализована поддержка следующих моделей машинного обучения:
  - **SVM** (Support Vector Machine) с радиальной функцией ядра.
  - **KNN** (K-Nearest Neighbors) с метрикой Манхэттена.
  - **Random Forest** (Случайный лес).
- Перед обучением признаки нормализуются с использованием **StandardScaler**.

### Этап 5: Оценка качества
- Оценка модели проводится на тестовой выборке.
- Вычисляются следующие метрики:
  - **Accuracy** (точность классификации).
  - **Confusion Matrix** (матрица ошибок).
  - **Classification Report** (отчет о классификации).

### Этап 6: Визуализация
- Визуализируются:
  - Гистограммы кластеров признаков для каждого класса.
  - Распределение классов в обучающей и тестовой выборках.
  - Матрица ошибок.

## Запуск приложения

```
python script.py -trd <train_data_path> -tsd <test_data_path> -tsl <test_labels_file> -d <descriptor> -a <algorithm> -c <count_clusters>
```
- `train_data_path` — путь к папке с обучающими данными.
- `test_data_path` — путь к папке с тестовыми данными.
- `test_labels_file` — файл с метками тестовой выборки.
- `descriptor` — алгоритм для извлечения признаков (`sift` или `orb`). По умолчанию `sift`.
- `algorithm` — модель классификации (`svm`, `knn` или `rf`). По умолчанию `svm`.
- `count_clusters` — количество кластеров (по умолчанию 50).

### Пример запуска
```bash
python script.py -trd "dogs-vs-cats/train" -tsd "dogs-vs-cats/test" -tsl "dogs-vs-cats/test_labels.txt" -d sift -a svm -c 100
```
