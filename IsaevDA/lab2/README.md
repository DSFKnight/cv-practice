# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

## Описание
Приложение для детектирования объектов на изображениях и видео с использованием обученной нейронной сети YOLOv3. Приложение загружает изображения или видео, выполняет обнаружение объектов, отображает результаты с графической визуализацией и выводит статистику о найденных объектах.

---

## Алгоритмы обработки

### 1. Предварительная обработка изображений
Для подготовки изображения к обработке в модели YOLO выполняются следующие шаги:

1. **Изменение размера**:
   - Изображение преобразуется к размеру `416x416`, что соответствует входному слою YOLO.
   - Выполняется с помощью функции `cv2.dnn.blobFromImage`.

2. **Нормализация**:
   - Все пиксели изображения делятся на `255`, чтобы привести значения к диапазону `[0, 1]`.

3. **Переключение цветовых каналов**:
   - RGB-каналы изображения меняются местами на BGR, что соответствует формату OpenCV.

4. **Создание Blob**:
   - Полученное изображение упаковывается в Blob, который подается в нейронную сеть.

### 2. Обработка выхода сети
После прохождения изображения через модель YOLOv3 получаем набор выходных данных:

1. **Обработка детекций**:
   - Выход модели представляет собой массив, где каждая строка содержит данные о потенциально обнаруженном объекте.
   - Первые четыре значения описывают прямоугольник (центр, ширина, высота).
   - Последующие значения — это вероятности для каждого класса объектов.

2. **Фильтрация по порогу достоверности**:
   - Если достоверность (confidence) выше заданного порога, объект сохраняется для дальнейшей обработки.

3. **Применение Non-Maximum Suppression (NMS)**:
   - Для удаления пересекающихся прямоугольников с низкой достоверностью используется алгоритм NMS.
   - Сохраняются только те объекты, которые имеют наибольшую достоверность в группе пересекающихся областей.

4. **Сохранение результатов**:
   - Для каждого обнаруженного объекта сохраняется:
     - Прямоугольник (координаты верхнего левого угла, ширина и высота);
     - Класс объекта;
     - Достоверность.

### 3. Визуализация
Результаты отображаются следующим образом:
- На изображении или кадре видео рисуются прямоугольники разного цвета вокруг объектов.
- В верхней части прямоугольника указывается название класса объекта.
- Внутри прямоугольника отображается достоверность наличия объекта (с точностью до трех знаков после запятой).

### 4. Вывод статистики
Программа подсчитывает количество объектов каждого класса и выводит эту информацию в консоль для изображения или всех обработанных кадров видео.

---

## Пример использования
### 1. Обработка изображения
```bash
python detector.py image image.jpg --confidence 0.6 --nms 0.3
```
- **image** — тип входных данных.
- **image.jpg** — путь к изображению.
- **--confidence** — порог достоверности для фильтрации объектов (по умолчанию 0.5).
- **--nms** — порог для Non-Maximum Suppression (по умолчанию 0.4).

### 2. Обработка видео
```bash
python detector.py video video.mp4 --confidence 0.5 --nms 0.4
```
- **video** — тип входных данных.
- **video.mp4** — путь к видеофайлу.

---

## Выводы
- Реализованное приложение демонстрирует использование нейронных сетей для задачи детектирования объектов.
- OpenCV DNN-модуль обеспечивает удобный интерфейс для работы с предобученными моделями.
- Программа позволяет гибко настраивать параметры порогов (достоверности и NMS), что делает её универсальной для работы с различными данными.

