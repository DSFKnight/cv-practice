# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV
**Задача.** Разработать приложение для детектирования объектов с использованием какой-либо обученной нейронной сети, которая доступна среди "зоопарка" моделей OpenCV. Классы целевых объектов для детектирования выбираются индивидуально, исходя из возможностей используемой модели.

## Описание
Реализовано приложение для детектирования объектов с использованием обученной нейронной сети YOLOv3.
### Описание ключевых аспектов программы
#### Структура программы
- Для инициализации (загрузки) сети используется функция `initializeModel()`, опишем её основные этапы:
	1. Загружается модель в OpenCV с помощью функции `cv2.dnn.readNet()`. Для загрузки модели используются файлы, содержащие веса и конфигурацию модели
	2. Получение имен выходных слоев модели с помощью функций `cv2.dnn_Net.getLayersNames()` и `cv2.dnn_Net.getUnconnectedOutLayers()`, они нам понадобятся для корректного интерпретирования выхода нейронной сети
	3. Получение названий всех классов, которые мы можем обнаружить
	Для того, чтобы эти действия сработали необходимо иметь в той же директории, что и `lab2.py` файлы `yolov3.cfg`, `yolov3.weights` и `coco.names`
- Функция `detect()` является отправной точкой в программе, она подготавлиет изображение, прогоняет его через нейронную сеть (прямое распространение через сеть), а также использует другие функции для анализа результатов и отображении их пользователю
- Функция `processNetworkOutput()` для всех выходов сети проводит следующий анализ:
	- Во-первых отсеивает выходы, значение confidence которых меньше выставляемого пользователем порога
	- Во-вторых для тех, кто не был отсеян, приводит данные в удобный вид
- Функция `drawDetections()` отображет итоговое изображение пользователю и выводит статистику в консоль
#### Используемые алгоритмы
1. Алгоритм не-максимального подавления (NMS, Non-Maximum Suppression)
	Используется для того, чтобы отфильтровать перекрывающиеся ограниченные рамки, которые предсказывают один и тот же объект
### Описание аргументов командной строки
Доступны следующие аргументы:
- `-i` или `--imagePath` $-$ путь к изображению
- `-c` или `--confidence` $-$ установление порога уверенности сети в изображении, если порог ниже чем указанный, то мы не будем учитывать данный выход сети. По умолчанию $0.5$, тип - `float`
- `-n` или `--nms` $-$  установление порога немаксимального подавления. По умолчанию $0.4$, тип - `float`
### Пример запуска
```sh
path/to/python lab2.py -i picture.jpg -c 0.8 -n 0.6
```