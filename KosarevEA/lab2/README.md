# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

Программа реализует систему обнаружения объектов на основе предобученной модели SSD MobileNet с использованием библиотеки OpenCV.

## initialize_model(weight_file, config_file)
Загружает модель SSD MobileNet из указанных файлов весов и конфигурации.
Параметры:
weight_file: Путь к файлу с весами модели.
config_file: Путь к файлу конфигурации модели.
Возвращает: Объект сети (нейронной сети) OpenCV.

## create_input_tensor(image, size=(300, 300), scale=0.007843, mean=(127.5, 127.5, 127.5))
Преобразует входное изображение в тензор для подачи в модель.
Параметры:
image: Исходное изображение.
size: Размер выходного тензора (по умолчанию 300x300).
scale: Масштабный коэффициент для нормализации (по умолчанию 0.007843).
mean: Средние значения для вычитания из каждого канала (по умолчанию (127.5, 127.5, 127.5)).
Возвращает: Тензор (blob) для подачи в нейронную сеть.

## fetch_predictions(model, input_blob, h, w, confidence_threshold=0.5)
Получает предсказания от модели на основе входного тензора.
Параметры:
model: Объект модели.
input_blob: Входной тензор (blob).
h: Высота исходного изображения.
w: Ширина исходного изображения.
confidence_threshold: Порог уверенности для фильтрации предсказаний (по умолчанию 0.5).
Возвращает: Список предсказаний в формате (class_id, confidence, (x1, y1, x2, y2)).

## draw_predictions(image, predictions)
Отображает предсказания на изображении.
Параметры:
image: Изображение для отображения результатов.
predictions: Список предсказаний от модели.
Возвращает: Обработанное изображение с нарисованными рамками и словарь обнаруженных объектов.

## load_image(image_path)
Загружает изображение из указанного пути.
Параметры:
image_path: Путь к изображению.
Возвращает: Загруженное изображение или None, если загрузка не удалась.

## resize_image(image)
Изменяет размер изображения вдвое меньше оригинала.
Параметры:
image: Исходное изображение.
Возвращает: Измененное по размеру изображение.

## process_image(image, model, conf_threshold)
Обрабатывает изображение: создает тензор, получает предсказания и отображает результаты.
Параметры:
image: Исходное изображение для обработки.
model: Объект модели для детекции объектов.
conf_threshold: Порог уверенности для фильтрации предсказаний.
Возвращает: Обработанное изображение и словарь обнаруженных объектов.

## display_results(image, detected_objects)
Отображает результаты детекции на экране и выводит количество обнаруженных объектов каждого класса в консоль.
Параметры:
image: Изображение с результатами детекции.
detected_objects: Словарь обнаруженных объектов и их количества.

## handle_image(image_path, model, conf_threshold=0.5)
Обрабатывает изображение по указанному пути с использованием модели и порога уверенности.
Параметры:
image_path: Путь к изображению для обработки.
model: Объект модели для детекции объектов.
conf_threshold: Порог уверенности для фильтрации предсказаний (по умолчанию 0.5).

## handle_video(video_path, model, conf_threshold=0.5, target_width=640, target_height=480)
Обрабатывает видеофайл и отображает результаты детекции в реальном времени.
Параметры:
video_path: Путь к видеофайлу для обработки.
model: Объект модели для детекции объектов.
conf_threshold: Порог уверенности для фильтрации предсказаний (по умолчанию 0.5).
target_width, target_height: Целевые размеры кадров видео.

## handle_image_frame(frame, model, conf_threshold=0.5)
Обрабатывает один кадр видео с использованием модели и возвращает обработанный кадр с результатами детекции.
Параметры:
frame: Кадр видео для обработки.
model: Объект модели для детекции объектов.
conf_threshold: Порог уверенности для фильтрации предсказаний (по умолчанию 0.5).
Возвращает: Обработанный кадр с нарисованными рамками и текстом.

## parse_arguments()
Парсит аргументы командной строки для запуска скрипта.
Возвращает: Объект с параметрами командной строки.